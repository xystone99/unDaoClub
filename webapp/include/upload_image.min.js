 
/****************************************************************************************************
 * 上传文件
 *
 * uType		:  上传类型[0:合同报价]
 * objForm		:  所属Form对象
 * objFile		:  文件选择框对象
 * hImageList	:  上传文件列表
 * divID		:  显示图片的DIV标签的ID
 ****************************************************************************************************/
function uploadFile( uType, objForm, objFile, hImageList, divID ) {	
	if ( objFile.value.length <= 1 ) {
		alert( "您未选择要上传的文件..." );
		return;
	}
	var arrURL = ['/uploadcontract'];
	objForm.enctype = "multipart/form-data";	
	
	$.ajaxFileUpload({
		url: arrURL[uType],						//需要链接到服务器地址
		secureuri: false,
		fileElementId: objFile.id,				//文件选择框的id属性
		dataType: 'json',						//服务器返回的格式，可以是json
		success: function (data, status) {		//相当于java中try语句块的用法, data是从服务器返回来的值   
			objForm.enctype = "application/x-www-form-urlencoded";
			if ( data.FileName.length == 0 ) {
				alert( "操作失败！" );
				return;
			}
			var imgList = hImageList.value;
			hImageList.value = imgList.length > 0 ? imgList + "=" + data.FileName : data.FileName;
			viewImageList( hImageList, divID );
 		},
		error: function (data, status, e) {		//相当于java中catch语句块的用法
 			alert( data.status );
		}
	});
} 
function deleteImage( imageListName, divID, imgName ) {
	if ( !confirm( "您确定删除该图片吗？" ) ) {
		return;
	}
	var reg = new RegExp( imgName, "g" ); 
	var reg1 = new RegExp( imgName+"=", "g" ); 
	var reg2 = new RegExp( "="+imgName, "g" );
	var objImageList = document.getElementsByName(imageListName )[0];
	var imageList = objImageList.value;
	objImageList.value = imageList.replace(reg1,"").replace(reg2,"").replace(reg,"");
	viewImageList( objImageList, divID );
}
function viewImageList( hImageList, divID ) {		//显示图片列表到DIV中
	if ( hImageList.value.length <= 1 ) {
		$("#"+divID).html( "&nbsp;" );
		return;
	}
	var arr_list = hImageList.value.split("=");
	var strHtml = "<table width=\"100%\">"
	for( var j=0; j<arr_list.length; ) {
		strHtml = strHtml + "<tr height=\"28\">";
		var strActionHtml = "<tr height=\"20\">";
		for ( var i=1; i <=6; i++ ) {
			strHtml = strHtml + "<td width=\"100\" align=\"left\" valign=\"bottom\">";
			strActionHtml = strActionHtml + "<td width=\"100\" align=\"left\" valign=\"top\">";
			if ( j<arr_list.length ) {
				strHtml = strHtml + "<a target=\"_blank\" href=\"" + arr_list[j] + "\"><img src=\"" + arr_list[j] + "\" width=\"100\"></a>"
				strActionHtml = strActionHtml + "<a href=\"javascript:deleteImage('" + hImageList.name + "','" + divID + "','" + arr_list[j] + "');\">删除</a>&nbsp;";
				j++;
			}
			strHtml = strHtml + "</td>";
			strActionHtml = strActionHtml + "</td>";
		}
		strHtml = strHtml + "</tr>";
		strActionHtml = strActionHtml + "</tr>";
		strHtml = strHtml + strActionHtml;
	}
	strHtml = strHtml + "</table>";
	$("#"+divID).html( strHtml );
}